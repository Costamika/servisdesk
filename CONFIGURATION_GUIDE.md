# Руководство по конфигурации ServisDesk

## Обзор

Система ServisDesk теперь поддерживает гибкую настройку IP адреса и порта через конфигурационный файл. Это позволяет легко изменять настройки сервера без редактирования кода.

## Файлы конфигурации

### 1. `config_ip_system.py` - Основной конфигурационный файл

```python
# IP адрес для запуска сервера
DEFAULT_HOST = "0.0.0.0"  # Доступ со всех интерфейсов

# Порт для запуска сервера
DEFAULT_PORT = 8080  # Измените на нужный порт

# Режим отладки
DEBUG_MODE = True  # True для разработки, False для продакшена

# Разрешенные хосты
ALLOWED_HOSTS = [
    DEFAULT_HOST,
    "localhost", 
    "127.0.0.1",
    "192.168.0.149",  # Ваш локальный IP
]
```

### 2. `run_server.py` - Python скрипт запуска

Умный скрипт для запуска сервера с проверками и настройками.

### 3. `start_server.sh` - Bash скрипт запуска

Удобный bash скрипт с цветным выводом и автоматическими проверками.

## Способы запуска

### 1. Через Python скрипт (рекомендуется)

```bash
# Запуск с настройками по умолчанию
python3 run_server.py

# Запуск с переопределением хоста и порта
python3 run_server.py --host 127.0.0.1 --port 9000

# Запуск с кастомным конфигурационным файлом
python3 run_server.py --config my_config.py
```

### 2. Через Bash скрипт

```bash
# Запуск с настройками по умолчанию
./start_server.sh

# Запуск с переопределением параметров
./start_server.sh --host 127.0.0.1 --port 9000
```

### 3. Традиционный способ (Django)

```bash
# Запуск с настройками из конфигурационного файла
python3 manage.py runserver 0.0.0.0:8080
```

## Примеры конфигураций

### Для локальной разработки

```python
DEFAULT_HOST = "127.0.0.1"
DEFAULT_PORT = 8000
DEBUG_MODE = True
```

### Для доступа из сети

```python
DEFAULT_HOST = "0.0.0.0"
DEFAULT_PORT = 8080
DEBUG_MODE = True
```

### Для продакшена

```python
DEFAULT_HOST = "0.0.0.0"
DEFAULT_PORT = 9000
DEBUG_MODE = False
```

### Для Docker контейнера

```python
DEFAULT_HOST = "0.0.0.0"
DEFAULT_PORT = 8000
DEBUG_MODE = False
```

## Безопасность

### Рекомендуемые порты

- **8000** - стандартный порт Django
- **8080** - альтернативный порт
- **9000** - порт для продакшена
- **5000** - порт для Flask приложений

### Порта для избежания

- **80** - требует прав администратора
- **443** - требует прав администратора
- **22** - SSH порт
- **3306** - MySQL порт

### Настройки безопасности

```python
# Для продакшена
DEBUG_MODE = False
ALLOWED_HOSTS = [
    "your-domain.com",
    "www.your-domain.com",
    "your-server-ip"
]

# Для разработки
DEBUG_MODE = True
ALLOWED_HOSTS = [
    "localhost",
    "127.0.0.1",
    "0.0.0.0"
]
```

## Автоматическая интеграция

### Django Settings

Настройки автоматически интегрируются в `servisdesk/settings.py`:

```python
# Импортируем конфигурацию IP и порта
try:
    from config_ip_system import ALLOWED_HOSTS, DEBUG_MODE
except ImportError:
    # Значения по умолчанию
    ALLOWED_HOSTS = ["localhost", "127.0.0.1", "0.0.0.0"]
    DEBUG_MODE = True

# Используем импортированные настройки
DEBUG = DEBUG_MODE
```

## Мониторинг и логирование

### Проверка статуса сервера

```bash
# Проверка процессов
ps aux | grep "run_server.py"

# Проверка портов
netstat -tlnp | grep :8080

# Проверка доступности
curl -s -o /dev/null -w "%{http_code}" http://localhost:8080/
```

### Логирование

Сервер автоматически логирует:
- Запуск и остановку
- Ошибки конфигурации
- Статус Django
- HTTP запросы

## Устранение неполадок

### Проблема: Порт занят

```bash
# Найти процесс на порту
sudo lsof -i :8080

# Остановить процесс
sudo kill -9 <PID>
```

### Проблема: Ошибка конфигурации

```bash
# Проверить синтаксис Python
python3 -m py_compile config_ip_system.py

# Проверить импорт
python3 -c "from config_ip_system import *; print('OK')"
```

### Проблема: Django не запускается

```bash
# Проверить настройки Django
python3 manage.py check

# Проверить миграции
python3 manage.py showmigrations
```

## Миграция с старой системы

### Старый способ
```bash
python3 manage.py runserver 0.0.0.0:8000
```

### Новый способ
```bash
# 1. Настроить config_ip_system.py
# 2. Запустить через скрипт
python3 run_server.py
```

## Преимущества новой системы

1. **Гибкость** - легко изменять настройки без редактирования кода
2. **Безопасность** - централизованное управление настройками
3. **Удобство** - автоматические проверки и цветной вывод
4. **Совместимость** - работает с существующим кодом
5. **Масштабируемость** - легко добавлять новые настройки

## Заключение

Новая система конфигурации делает ServisDesk более гибким и удобным в использовании. Теперь вы можете легко настраивать сервер под различные сценарии использования без необходимости редактирования кода.
